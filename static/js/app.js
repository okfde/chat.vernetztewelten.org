(function(e){function t(t){for(var r,s,i=t[0],c=t[1],u=t[2],m=0,d=[];m<i.length;m++)s=i[m],o[s]&&d.push(o[s][0]),o[s]=0;for(r in c)Object.prototype.hasOwnProperty.call(c,r)&&(e[r]=c[r]);l&&l(t);while(d.length)d.shift()();return a.push.apply(a,u||[]),n()}function n(){for(var e,t=0;t<a.length;t++){for(var n=a[t],r=!0,i=1;i<n.length;i++){var c=n[i];0!==o[c]&&(r=!1)}r&&(a.splice(t--,1),e=s(s.s=n[0]))}return e}var r={},o={app:0},a=[];function s(t){if(r[t])return r[t].exports;var n=r[t]={i:t,l:!1,exports:{}};return e[t].call(n.exports,n,n.exports,s),n.l=!0,n.exports}s.m=e,s.c=r,s.d=function(e,t,n){s.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},s.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},s.t=function(e,t){if(1&t&&(e=s(e)),8&t)return e;if(4&t&&"object"===typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(s.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var r in e)s.d(n,r,function(t){return e[t]}.bind(null,r));return n},s.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return s.d(t,"a",t),t},s.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},s.p="/static/";var i=window["webpackJsonp"]=window["webpackJsonp"]||[],c=i.push.bind(i);i.push=t,i=i.slice();for(var u=0;u<i.length;u++)t(i[u]);var l=c;a.push([0,"chunk-vendors"]),n()})({0:function(e,t,n){e.exports=n("cd49")},"5c0b":function(e,t,n){"use strict";var r=n("5e27"),o=n.n(r);o.a},"5e27":function(e,t,n){},cd49:function(e,t,n){"use strict";n.r(t);n("7f7f");var r=n("5d73"),o=n.n(r),a=(n("a481"),n("cadf"),n("551c"),n("f751"),n("097d"),n("2b0e")),s=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{attrs:{id:"app"}},[e._m(0),n("router-view",{attrs:{session:e.session,room:e.room,countries:e.countries}})],1)},i=[function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"container"},[n("div",{staticClass:"row"},[n("div",{staticClass:"col-4"},[e._v("\n        Logo\n      ")]),n("div",{staticClass:"col-8"},[e._v("\n        Navigation\n      ")])])])}],c=n("d225"),u=n("308d"),l=n("6bb5"),m=n("4e2b"),d=n("9ab4"),v=n("60a3"),p=function(e){function t(){return Object(c["a"])(this,t),Object(u["a"])(this,Object(l["a"])(t).apply(this,arguments))}return Object(m["a"])(t,e),t}(v["c"]);p=d["a"]([Object(v["a"])({props:{session:{type:Object,default:null},room:{type:Object,default:null},countries:{type:Array}}})],p);var f=p,h=f,y=(n("5c0b"),n("2877")),b=Object(y["a"])(h,s,i,!1,null,null,null),g=b.exports,_=n("8c4f"),O=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"home"},[n("Login",{attrs:{session:e.session,room:e.room,countries:e.countries}})],1)},j=[],k=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"login"},[n("h3",[e._v("Login")]),e.error?n("div",{staticClass:"alert alert-danger"},[e._v("\n    "+e._s(e.error)+"\n  ")]):e._e(),n("form",{attrs:{action:"/enter",method:"post"},on:{submit:e.enterRoom}},[n("p",[n("label",{attrs:{for:"id_room"}},[e._v("Room:")]),n("input",{directives:[{name:"model",rawName:"v-model",value:e.roomName,expression:"roomName"}],attrs:{type:"text",name:"room",required:"",id:"id_room"},domProps:{value:e.roomName},on:{input:function(t){t.target.composing||(e.roomName=t.target.value)}}})]),n("p",[n("label",{attrs:{for:"id_username"}},[e._v("Username:")]),n("input",{directives:[{name:"model",rawName:"v-model",value:e.username,expression:"username"}],attrs:{type:"text",name:"username",maxlength:"255",required:"",id:"id_username"},domProps:{value:e.username},on:{input:function(t){t.target.composing||(e.username=t.target.value)}}})]),n("p",[n("label",{attrs:{for:"id_country"}},[e._v("Country:")]),n("select",{directives:[{name:"model",rawName:"v-model",value:e.country,expression:"country"}],attrs:{name:"country",required:"",id:"id_country"},on:{change:function(t){var n=Array.prototype.filter.call(t.target.options,function(e){return e.selected}).map(function(e){var t="_value"in e?e._value:e.value;return t});e.country=t.target.multiple?n:n[0]}}},e._l(e.countries,function(t){return n("option",{key:t[0],domProps:{value:t[0]}},[e._v("\n        "+e._s(t[1])+"\n      ")])}),0)]),n("button",{attrs:{type:"submit"}},[e._v("Eintreten")])])])},w=[],x=n("f499"),N=n.n(x),S=n("b0b4"),C=function(e){function t(){var e;return Object(c["a"])(this,t),e=Object(u["a"])(this,Object(l["a"])(t).apply(this,arguments)),e.username="",e.roomName="",e.country="",e.error="",e}return Object(m["a"])(t,e),Object(S["a"])(t,[{key:"mounted",value:function(){null!==this.room&&(this.roomName=this.room.name),null!==this.session&&(this.username=this.session.username,this.country=this.session.country)}},{key:"enterRoom",value:function(e){var t=this;e.preventDefault(),this.error="",window.fetch("/enter/",{method:"POST",credentials:"same-origin",headers:{"Content-Type":"application/json","X-Requested-With":"XMLHttpRequest","X-CSRFToken":this.csrfToken},body:N()({username:this.username,room:this.roomName,country:this.country})}).then(function(e){return e.json()}).then(function(e){e.error&&(console.error(e.message),t.error=e.message),pe.replace(e.room)})}},{key:"csrfToken",get:function(){var e=document.querySelector("input[name=csrfmiddlewaretoken]");return null!==e?e.value:""}}]),t}(v["c"]);d["a"]([Object(v["b"])({type:Object,default:null})],C.prototype,"session",void 0),d["a"]([Object(v["b"])({type:Object,default:null})],C.prototype,"room",void 0),d["a"]([Object(v["b"])(Array)],C.prototype,"countries",void 0),C=d["a"]([v["a"]],C);var E=C,I=E,M=Object(y["a"])(I,k,w,!1,null,"b6b14828",null),P=M.exports,$=function(e){function t(){return Object(c["a"])(this,t),Object(u["a"])(this,Object(l["a"])(t).apply(this,arguments))}return Object(m["a"])(t,e),t}(v["c"]);$=d["a"]([Object(v["a"])({components:{Login:P},props:{session:{type:Object,default:null},room:{type:Object,default:null},countries:{type:Array}}})],$);var A=$,q=A,T=Object(y["a"])(q,O,j,!1,null,null,null),U=T.exports,B=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"about"},[n("h1",[e._v("\n    Chat room\n    "),e.roomName?n("span",[e._v("\n    „"+e._s(e.roomName)+"“\n    ")]):e._e()]),e.session?n("span",[e._v("\n    Username: "+e._s(e.session.username)+" ("+e._s(e.session.country)+")\n  ")]):e._e(),n("user-list",{attrs:{users:e.users}}),n("message-list",{attrs:{messages:e.messages},on:{sendmessage:e.sendMessage}}),n("dictionary",{attrs:{dictionary:e.dictionary},on:{addentry:e.addDictionaryEntry}})],1)},L=[],R=(n("55dd"),n("75fc")),D=(n("ac6a"),function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",[n("h3",[e._v("Users")]),n("ul",e._l(e.users,function(t){return n("li",[e._v("\n      "+e._s(t.username)+"\n    ")])}),0)])}),J=[],F=function(e){function t(){return Object(c["a"])(this,t),Object(u["a"])(this,Object(l["a"])(t).apply(this,arguments))}return Object(m["a"])(t,e),t}(v["c"]);d["a"]([Object(v["b"])(Array)],F.prototype,"users",void 0),F=d["a"]([v["a"]],F);var X=F,W=X,H=Object(y["a"])(W,D,J,!1,null,null,null),z=H.exports,G=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",[n("h3",[e._v("Messages")]),n("ul",e._l(e.messages,function(t){return n("li",[e._v("\n      "+e._s(t.username)+":\n      "),n("code",[e._v("\n        "+e._s(t.message)+"\n      ")])])}),0),n("input",{directives:[{name:"model",rawName:"v-model",value:e.message,expression:"message"}],attrs:{type:"text"},domProps:{value:e.message},on:{keyup:function(t){return"button"in t||!e._k(t.keyCode,"enter",13,t.key,"Enter")?e.submitMessage(t):null},input:function(t){t.target.composing||(e.message=t.target.value)}}})])},K=[],Q=function(e){function t(){var e;return Object(c["a"])(this,t),e=Object(u["a"])(this,Object(l["a"])(t).apply(this,arguments)),e.message="",e}return Object(m["a"])(t,e),Object(S["a"])(t,[{key:"submitMessage",value:function(){this.$emit("sendmessage",this.message),this.message=""}}]),t}(v["c"]);d["a"]([Object(v["b"])(Array)],Q.prototype,"messages",void 0),Q=d["a"]([v["a"]],Q);var V=Q,Y=V,Z=Object(y["a"])(Y,G,K,!1,null,null,null),ee=Z.exports,te=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",[n("h3",[e._v("Dictionary")]),n("dl",[e._l(e.dictionary,function(t){return[n("dt",{key:"dt"+t.id},[n("code",[e._v(e._s(t.word))])]),n("dd",{key:"dd"+t.id},[e._v("\n        "+e._s(t.meaning)+"\n      ")])]})],2),n("input",{directives:[{name:"model",rawName:"v-model",value:e.word,expression:"word"}],attrs:{type:"text"},domProps:{value:e.word},on:{input:function(t){t.target.composing||(e.word=t.target.value)}}}),n("input",{directives:[{name:"model",rawName:"v-model",value:e.meaning,expression:"meaning"}],attrs:{type:"text",maxlength:"255"},domProps:{value:e.meaning},on:{keyup:function(t){return"button"in t||!e._k(t.keyCode,"enter",13,t.key,"Enter")?e.addEntry(t):null},input:function(t){t.target.composing||(e.meaning=t.target.value)}}})])},ne=[],re=function(e){function t(){var e;return Object(c["a"])(this,t),e=Object(u["a"])(this,Object(l["a"])(t).apply(this,arguments)),e.word="",e.meaning="",e}return Object(m["a"])(t,e),Object(S["a"])(t,[{key:"addEntry",value:function(){""!==this.word&&""!==this.meaning&&(this.$emit("addentry",{word:this.word,meaning:this.meaning}),this.word="",this.meaning="")}}]),t}(v["c"]);d["a"]([Object(v["b"])(Array)],re.prototype,"dictionary",void 0),re=d["a"]([v["a"]],re);var oe=re,ae=oe,se=Object(y["a"])(ae,te,ne,!1,null,null,null),ie=se.exports,ce=function(e,t){return e.timestamp>t.timestamp?1:e.timestamp<t.timestamp?-1:0},ue=function(e){function t(){var e;return Object(c["a"])(this,t),e=Object(u["a"])(this,Object(l["a"])(t).apply(this,arguments)),e.socket=null,e.messages=[],e.users=[],e.dictionary=[],e.roomName=null,e.session=null,e.heartBeatInterval=void 0,e.retryInterval=void 0,e}return Object(m["a"])(t,e),Object(S["a"])(t,[{key:"mounted",value:function(){this.connectSocket()}},{key:"connectSocket",value:function(){var e=this;this.socket=this.createSocket(),this.retryInterval&&(window.clearInterval(this.retryInterval),this.retryInterval=void 0),this.socket.onopen=function(t){e.heartBeatInterval=setInterval(function(){e.socket&&1===e.socket.readyState?e.socket.send(N()({type:"heartbeat"})):(window.clearInterval(e.heartBeatInterval),e.heartBeatInterval=void 0)},3e4)},this.socket.onmessage=function(t){var n=JSON.parse(t.data);n.messages&&(e.messages=e.mergeMessages(n.messages)),n.userlist&&(e.users=n.userlist),n.you&&(e.session=n.you),n.dictionary&&(e.dictionary=n.dictionary),n.user&&console.log("".concat(n.user.username," ").concat(n.user.action)),n.name&&(e.roomName=n.name)},this.socket.onclose=function(t){console.error("Chat socket closed unexpectedly"),window.clearInterval(e.heartBeatInterval),e.heartBeatInterval=void 0,void 0===e.retryInterval&&(e.retryInterval=window.setInterval(e.connectSocket,3e3))}}},{key:"mergeMessages",value:function(e){var t={};this.messages.forEach(function(e){return t[e.id]=!0});var n=e.filter(function(e){return void 0===t[e.id]}),r=[].concat(Object(R["a"])(this.messages),Object(R["a"])(n));return r.sort(ce)}},{key:"createSocket",value:function(){return new WebSocket("ws://".concat(window.location.host,"/ws/chat/").concat(this.roomUid,"/"))}},{key:"sendMessage",value:function(e){null===this.socket&&this.connectSocket(),null!==this.socket&&this.socket.send(N()({type:"message",message:e}))}},{key:"addDictionaryEntry",value:function(e){null===this.socket&&this.connectSocket(),null!==this.socket&&this.socket.send(N()({type:"dictionary_entry",entry:e}))}}]),t}(v["c"]);d["a"]([Object(v["b"])(String)],ue.prototype,"roomUid",void 0),ue=d["a"]([Object(v["a"])({components:{UserList:z,MessageList:ee,Dictionary:ie}})],ue);var le=ue,me=le,de=Object(y["a"])(me,B,L,!1,null,null,null),ve=de.exports;a["default"].use(_["a"]);var pe=new _["a"]({mode:"history",base:"/",routes:[{path:"/",name:"home",component:U},{path:"/room/:roomUid/",name:"room",component:ve,props:!0}]}),fe=n("9483");function he(e){return e.replace(/(-\w)/g,function(e){return e[1].toUpperCase()})}function ye(e){var t=e.attributes,n={},r=!0,a=!1,s=void 0;try{for(var i,c=o()(t);!(r=(i=c.next()).done);r=!0){var u=i.value;if(("v"!==u.name[0]||"-"!==u.name[1])&&("id"!==u.name&&"class"!==u.name)){var l=u.value,m=!1,d=u.name;":"===u.name[0]&&(d=u.name.substring(1),"{"!==u.value[0]&&"["!==u.value[0]||(l=JSON.parse(u.value)),"true"===u.value&&(m=!0),"null"===u.value&&(m=null));var v=he(d);n[v]=!1!==m?m:l}}}catch(p){a=!0,s=p}finally{try{r||null==c.return||c.return()}finally{if(a)throw s}}return n}Object(fe["a"])("".concat("/static/","service-worker.js"),{ready:function(){console.log("App is being served from cache by a service worker.\nFor more details, visit https://goo.gl/AFskqB")},registered:function(){console.log("Service worker has been registered.")},cached:function(){console.log("Content has been cached for offline use.")},updatefound:function(){console.log("New content is downloading.")},updated:function(){console.log("New content is available; please refresh.")},offline:function(){console.log("No internet connection found. App is running in offline mode.")},error:function(e){console.error("Error during service worker registration:",e)}}),a["default"].config.productionTip=!1;var be="#app",ge=document.querySelector(be);null!==ge&&new a["default"]({router:pe,render:function(e){return e(g,{props:ye(ge)})}}).$mount(be)}});
//# sourceMappingURL=app.js.map